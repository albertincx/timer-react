var ie=Object.defineProperty;var se=(e,t,i)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var j=(e,t,i)=>(se(e,typeof t!="symbol"?t+"":t,i),i);import{r as f,j as l,x as L,S as $}from"./index-MtDNrbqC.js";var ne=Object.defineProperty,oe=(e,t,i)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,d=(e,t,i)=>(oe(e,typeof t!="symbol"?t+"":t,i),i);const S=class{constructor(e){d(this,"mobileSelect"),d(this,"trigger"),d(this,"wheelList"),d(this,"sliderList"),d(this,"wheelsContain"),d(this,"panel"),d(this,"ensureBtn"),d(this,"cancelBtn"),d(this,"grayLayer"),d(this,"popUp"),d(this,"initPosition"),d(this,"initColWidth"),d(this,"wheelsData"),d(this,"displayJson"),d(this,"curValue"),d(this,"curIndexArr"),d(this,"isCascade"),d(this,"isJsonType"),d(this,"startY"),d(this,"moveEndY"),d(this,"moveY"),d(this,"preMoveY"),d(this,"offsetY"),d(this,"offsetSum"),d(this,"oversizeBorder"),d(this,"enableClickStatus"),d(this,"isPC"),d(this,"optionHeight"),d(this,"curDistance"),d(this,"cascadeJsonData"),d(this,"eventHandleMap"),d(this,"initDeepCount"),d(this,"config"),!S.checkRequiredConfig(e)||(this.config=Object.assign({},S.defaultConfig,e),this.wheelsData=e.wheels,this.isJsonType=!1,this.cascadeJsonData=[],this.displayJson=[],this.curValue=[],this.curIndexArr=[],this.isCascade=!1,this.startY,this.moveEndY,this.moveY,this.preMoveY,this.offsetY=0,this.offsetSum=0,this.oversizeBorder,this.curDistance=[],this.enableClickStatus=!1,this.isPC=!0,this.optionHeight=0,this.initPosition=e.position||[],this.initColWidth=e.colWidth||[],this.init())}init(){const{config:e}=this;if(this.isJsonType=S.checkDataType(this.wheelsData),this.renderComponent(this.wheelsData),!!this.checkTriggerAvailable()){if(this.wheelList=this.mobileSelect.getElementsByClassName("ms-wheel"),this.sliderList=this.mobileSelect.getElementsByClassName("ms-select-container"),this.panel=this.mobileSelect.querySelector(".ms-panel"),this.wheelsContain=this.mobileSelect.querySelector(".ms-wheels"),this.ensureBtn=this.mobileSelect.querySelector(".ms-ensure"),this.cancelBtn=this.mobileSelect.querySelector(".ms-cancel"),this.grayLayer=this.mobileSelect.querySelector(".ms-gray-layer"),this.popUp=this.mobileSelect.querySelector(".ms-content"),this.optionHeight=this.mobileSelect.querySelector("li").offsetHeight,e.initValue&&e.triggerDisplayValue&&(this.trigger.innerText=e.initValue),this.setStyle(e),this.isPC=S.checkIsPC(),this.isCascade=this.checkCascade(),this.isCascade&&this.initCascade(),e.initValue&&(this.initPosition=this.getPositionByValue()),this.initPosition.length<this.sliderList.length){const t=this.sliderList.length-this.initPosition.length;for(let i=0;i<t;i++)this.initPosition.push(0)}this.isCascade?this.initPosition.forEach((t,i)=>{this.checkRange(i,this.initPosition)}):this.setCurDistance(this.initPosition),this.eventHandleMap={cancelBtn:{event:"click",fn:()=>{var t,i,s,n;this.hide(),(i=(t=this.config).cancel)==null||i.call(t,this.curIndexArr,this.curValue,this),(n=(s=this.config).onCancel)==null||n.call(s,this.curValue,this.curIndexArr,this)}},ensureBtn:{event:"click",fn:()=>{var t,i,s,n;this.hide(),this.optionHeight||(this.optionHeight=this.mobileSelect.querySelector("li").offsetHeight);let a="";for(let o=0;o<this.wheelList.length;o++)o==this.wheelList.length-1?a+=this.getInnerText(o):a+=this.getInnerText(o)+this.config.connector;e.triggerDisplayValue&&(this.trigger.innerText=a),this.curIndexArr=this.getIndexArr(),this.curValue=this.getCurValue(),(i=(t=this.config).callback)==null||i.call(t,this.curIndexArr,this.curValue,this),(n=(s=this.config).onChange)==null||n.call(s,this.curValue,this.curIndexArr,this)}},trigger:{event:"click",fn:()=>{this.show()}},grayLayer:{event:"click",fn:()=>this.hide()},popUp:{event:"click",fn:t=>t.stopPropagation()},panel:{event:["touchstart","touchend","touchmove"],fn:t=>this.touch(t)}},this.isPC&&(this.eventHandleMap.panel.event=["mousedown","mousemove","mouseup"]),this.registerEvents("add"),this.fixRowStyle(),e.autoFocus&&this.show()}}static checkIsPC(){return!navigator.userAgent.toLowerCase().match(/ipad|iphone os|midp|rv:1.2.3.4|ucweb|android|windows ce|windows mobile/)}static checkDataType(e){var t,i;return typeof((i=(t=e[0])==null?void 0:t.data)==null?void 0:i[0])=="object"}static checkRequiredConfig(e){const t=S.REQUIRED_PARAMS;if(!e){const i=t.map(s=>`'${s}'`);return S.log("error",`missing required param ${i.join(" and ")}.`),!1}for(let i=0;i<t.length;i++){const s=t[i];if(!e[s])return S.log("error",`missing required param '${s}'.`),!1}return!0}static log(e,t){var i;(i=console[e])==null||i.call(console,`[mobile-select]: ${t}`)}checkTriggerAvailable(){const{config:e}=this;return this.trigger=e.trigger instanceof HTMLElement?e.trigger:document.querySelector(e.trigger),this.trigger?!0:(S.log("error","trigger HTMLElement does not found on your document."),!1)}getPositionByValue(){var e;const{keyMap:t,connector:i,initValue:s}=this.config,n=(s==null?void 0:s.split(i))||[];if(this.isJsonType){let a=(e=this.wheelsData[0])==null?void 0:e.data;return n.reduce((o,g)=>{var c;const u=a==null?void 0:a.findIndex(m=>m[t.value]==g);return o.push(u<0?0:u),a=(c=a[u])==null?void 0:c[t.childs],o},[])}return n.reduce((a,o,g)=>{var c,u;const m=(u=(c=this.wheelsData[g])==null?void 0:c.data)==null?void 0:u.findIndex(r=>r==o);return a.push(m<0?0:m),a},[])}setTitle(e){this.mobileSelect.querySelector(".ms-title").innerHTML=e}setStyle(e){if(e.ensureBtnColor&&(this.ensureBtn.style.color=e.ensureBtnColor),e.cancelBtnColor&&(this.cancelBtn.style.color=e.cancelBtnColor),e.titleColor){const t=this.mobileSelect.querySelector(".ms-title");t.style.color=e.titleColor}if(e.textColor&&(this.panel=this.mobileSelect.querySelector(".ms-panel"),this.panel.style.color=e.textColor),e.titleBgColor){const t=this.mobileSelect.querySelector(".ms-btn-bar");t.style.backgroundColor=e.titleBgColor}if(e.bgColor){this.panel=this.mobileSelect.querySelector(".ms-panel");const t=this.mobileSelect.querySelector(".ms-shadow-mask");this.panel.style.backgroundColor=e.bgColor,t.style.background="linear-gradient(to bottom, "+e.bgColor+", rgba(255, 255, 255, 0), "+e.bgColor+")"}if(typeof e.maskOpacity=="number"){const t=this.mobileSelect.querySelector(".ms-gray-layer");t.style.background="rgba(0, 0, 0, "+e.maskOpacity+")"}}show(){var e,t,i;this.mobileSelect.classList.add("ms-show"),(e=document.querySelector("body"))==null||e.classList.add("ms-show"),typeof this.config.onShow=="function"&&((i=(t=this.config).onShow)==null||i.call(t,this.curValue,this.curIndexArr,this))}hide(){var e,t,i;this.mobileSelect.classList.remove("ms-show"),(e=document.querySelector("body"))==null||e.classList.remove("ms-show"),typeof this.config.onHide=="function"&&((i=(t=this.config).onHide)==null||i.call(t,this.curValue,this.curIndexArr,this))}registerEvents(e){for(const[t,i]of Object.entries(this.eventHandleMap))typeof i.event=="string"?this[t][`${e}EventListener`](i.event,i.fn,{passive:!1}):i.event.forEach(s=>{this[t][`${e}EventListener`](s,i.fn,{passive:!1})})}destroy(){var e,t;this.registerEvents("remove"),(t=(e=this.mobileSelect)==null?void 0:e.parentNode)==null||t.removeChild(this.mobileSelect)}getOptionsHtmlStr(e){const{keyMap:t}=this.config;let i="";if(this.isJsonType)for(let s=0;s<e.length;s++){const n=e[s][t.id],a=e[s][t.value];i+=`<li data-id="${n}">${a}</li>`}else for(let s=0;s<e.length;s++)i+="<li>"+e[s]+"</li>";return i}renderComponent(e){this.mobileSelect=document.createElement("div"),this.mobileSelect.className="ms-mobile-select",this.mobileSelect.innerHTML=`<div class="ms-gray-layer"></div>
        <div class="ms-content">
          <div class="ms-btn-bar">
            <div class="ms-fix-width">
              <div class="ms-cancel">${this.config.cancelBtnText}</div>  
              <div class="ms-title">${this.config.title||""}</div>
              <div class="ms-ensure">${this.config.ensureBtnText}</div>
            </div>
          </div>
          <div class="ms-panel">
            <div class="ms-fix-width">
            <div class="ms-wheels"></div>
            <div class="ms-select-line"></div>
            <div class="ms-shadow-mask"></div>
          </div>
        </div>`,document.body.appendChild(this.mobileSelect);let t="";for(let i=0;i<e.length;i++)t+=`<div class="ms-wheel" data-index="${i}"><ul class="ms-select-container">`,t+=this.getOptionsHtmlStr(e[i].data),t+="</ul></div>";this.mobileSelect.querySelector(".ms-wheels").innerHTML=t}reRenderWheels(){const e=this.wheelList.length-this.displayJson.length;if(e>0)for(let t=0;t<e;t++)this.wheelsContain.removeChild(this.wheelList[this.wheelList.length-1]);for(let t=0;t<this.displayJson.length;t++)if(this.wheelList[t])this.sliderList[t].innerHTML=this.getOptionsHtmlStr(this.displayJson[t]);else{const i=document.createElement("div");i.className="ms-wheel",i.innerHTML=`<ul class="ms-select-container">${this.getOptionsHtmlStr(this.displayJson[t])}</ul>`,i.setAttribute("data-index",t.toString()),this.wheelsContain.appendChild(i)}}checkCascade(){var e;const{keyMap:t}=this.config;if(this.isJsonType){const i=this.wheelsData[0].data;for(let s=0;s<i.length;s++)if(t.childs in i[s]&&((e=i[s][t.childs])==null?void 0:e.length)>0)return this.cascadeJsonData=this.wheelsData[0].data,!0}return!1}initCascade(){this.displayJson.push(this.cascadeJsonData),this.initPosition.length>0?(this.initDeepCount=0,this.initCheckArrDeep(this.cascadeJsonData[this.initPosition[0]])):this.checkArrDeep(this.cascadeJsonData[0]),this.reRenderWheels()}initCheckArrDeep(e){if(e){const{keyMap:t}=this.config;if(t.childs in e&&e[t.childs].length>0){this.displayJson.push(e[t.childs]),this.initDeepCount++;const i=e[t.childs][this.initPosition[this.initDeepCount]];i?this.initCheckArrDeep(i):this.checkArrDeep(e[t.childs][0])}}}checkArrDeep(e){if(!e)return;const{keyMap:t}=this.config;t.childs in e&&e[t.childs].length>0&&(this.displayJson.push(e[t.childs]),this.checkArrDeep(e[t.childs][0]))}checkRange(e,t){var i;const s=this.displayJson.length-1-e,{keyMap:n}=this.config;for(let o=0;o<s;o++)this.displayJson.pop();let a;for(let o=0;o<=e;o++)a=o==0?this.cascadeJsonData[t[0]]:(i=a==null?void 0:a[n.childs])==null?void 0:i[t[o]];this.checkArrDeep(a),this.reRenderWheels(),this.fixRowStyle(),this.setCurDistance(this.resetPosition(e,t))}resetPosition(e,t){const i=[...t];let s;if(this.sliderList.length>t.length){s=this.sliderList.length-t.length;for(let n=0;n<s;n++)i.push(0)}else if(this.sliderList.length<t.length){s=t.length-this.sliderList.length;for(let n=0;n<s;n++)i.pop()}for(let n=e+1;n<i.length;n++)i[n]=0;return i}updateWheels(e){if(this.isCascade){if(this.cascadeJsonData=e,this.displayJson=[],this.initCascade(),this.initPosition.length<this.sliderList.length){const t=this.sliderList.length-this.initPosition.length;for(let i=0;i<t;i++)this.initPosition.push(0)}this.setCurDistance(this.initPosition),this.fixRowStyle()}}updateWheel(e,t){if(this.isCascade){S.log("error","'updateWheel()' not support cascade json data, please use 'updateWheels()' instead to update the whole data source");return}let i="";i+=this.getOptionsHtmlStr(t),this.wheelsData[e]=this.isJsonType?{data:t}:t,this.sliderList[e].innerHTML=i}fixRowStyle(){if(this.initColWidth.length&&this.initColWidth.length===this.wheelList.length){const t=this.initColWidth.reduce((i,s)=>i+s,0);this.initColWidth.forEach((i,s)=>{this.wheelList[s].style.width=(i/t*100).toFixed(2)+"%"});return}const e=(100/this.wheelList.length).toFixed(2);for(let t=0;t<this.wheelList.length;t++)this.wheelList[t].style.width=e+"%"}getIndex(e){return Math.round((2*this.optionHeight-e)/this.optionHeight)}getIndexArr(){const e=[];for(let t=0;t<this.curDistance.length;t++)e.push(this.getIndex(this.curDistance[t]));return e}getCurValue(){const e=[],t=this.getIndexArr(),{keyMap:i}=this.config;if(this.isCascade)for(let s=0;s<this.wheelList.length;s++){const n=this.displayJson[s][t[s]];n&&e.push({[i.id]:n[i.id],[i.value]:n[i.value]})}else if(this.isJsonType)for(let s=0;s<this.curDistance.length;s++)e.push(this.wheelsData[s].data[this.getIndex(this.curDistance[s])]);else for(let s=0;s<this.curDistance.length;s++)e.push(this.getInnerText(s));return e}getValue(){return this.curValue}calcDistance(e){return 2*this.optionHeight-e*this.optionHeight}setCurDistance(e){const t=[];for(let i=0;i<this.sliderList.length;i++)t.push(this.calcDistance(e[i])),this.movePosition(this.sliderList[i],t[i]);this.curDistance=t}fixPosition(e){return-(this.getIndex(e)-2)*this.optionHeight}movePosition(e,t){e.style.transform="translate3d(0,"+t+"px, 0)"}locatePosition(e,t){this.curDistance[e]=this.calcDistance(t),this.movePosition(this.sliderList[e],this.curDistance[e]),this.isCascade&&this.checkRange(e,this.getIndexArr())}updateCurDistance(e,t){this.curDistance[t]=parseInt(e.style.transform.split(",")[1])}getInnerText(e){var t;const i=this.sliderList[e].getElementsByTagName("li").length;let s=this.getIndex(this.curDistance[e]);return s>=i?s=i-1:s<0&&(s=0),((t=this.sliderList[e].getElementsByTagName("li")[s])==null?void 0:t.innerText)||""}touch(e){var t,i,s,n,a,o,g,c;const u=(e.composedPath&&e.composedPath()).find(h=>{var p;return(p=h.classList)==null?void 0:p.contains("ms-wheel")});if(!u)return;const m=u.firstChild,r=parseInt(u.getAttribute("data-index")||"0");switch(e.type){case"touchstart":case"mousedown":m.style.transition="none 0s ease-out",this.startY=Math.floor(e instanceof TouchEvent?e.touches[0].clientY:e.clientY),this.preMoveY=this.startY,e.type==="mousedown"&&(this.enableClickStatus=!0);break;case"touchmove":case"mousemove":if(e.preventDefault(),e.type==="mousemove"&&!this.enableClickStatus)break;this.moveY=Math.floor(e instanceof TouchEvent?e.touches[0].clientY:e.clientY),this.offsetY=(this.moveY-this.preMoveY)*this.config.scrollSpeed,this.updateCurDistance(m,r),this.curDistance[r]=this.curDistance[r]+this.offsetY,this.movePosition(m,this.curDistance[r]),this.preMoveY=this.moveY;break;case"touchend":case"mouseup":if(m.style.transition="transform 0.18s ease-out",this.moveEndY=Math.floor(e instanceof TouchEvent?e.changedTouches[0].clientY:e.clientY),this.offsetSum=this.moveEndY-this.startY,this.oversizeBorder=-(m.getElementsByTagName("li").length-3)*this.optionHeight,this.offsetSum==0){const h=Math.floor((window.innerHeight-this.moveEndY)/40);if(h!=2){const p=h-2,v=this.curDistance[r]+p*this.optionHeight;v<=2*this.optionHeight&&v>=this.oversizeBorder&&(this.curDistance[r]=v,this.movePosition(m,this.curDistance[r]),(i=(t=this.config).transitionEnd)==null||i.call(t,this.getIndexArr(),this.getCurValue(),this),(n=(s=this.config).onTransitionEnd)==null||n.call(s,this.getCurValue(),this.getIndexArr(),this))}}else this.updateCurDistance(m,r),this.curDistance[r]=this.fixPosition(this.curDistance[r]),this.curDistance[r]>2*this.optionHeight?this.curDistance[r]=2*this.optionHeight:this.curDistance[r]<this.oversizeBorder&&(this.curDistance[r]=this.oversizeBorder),this.movePosition(m,this.curDistance[r]),(o=(a=this.config).transitionEnd)==null||o.call(a,this.getIndexArr(),this.getCurValue(),this),(c=(g=this.config).onTransitionEnd)==null||c.call(g,this.getCurValue(),this.getIndexArr(),this);e.type==="mouseup"&&(this.enableClickStatus=!1),this.isCascade&&this.checkRange(r,this.getIndexArr());break}}};let H=S;d(H,"defaultConfig",{keyMap:{id:"id",value:"value",childs:"childs"},position:[],colWidth:[],title:"",connector:" ",ensureBtnText:"确认",cancelBtnText:"取消",triggerDisplayValue:!0,scrollSpeed:1}),d(H,"REQUIRED_PARAMS",["trigger","wheels"]);function le(e){const t=f.useRef(null),i=f.useRef(null);return f.useEffect(()=>(i.current||(i.current=new H({...e.config,trigger:t.current,triggerDisplayValue:!e.children})),()=>{i==null||i.current.destroy(),i.current=null}),[]),l.jsx("div",{children:l.jsx("div",{className:"ms-default-trigger",ref:t,children:e.children||e.placeholder||"Custom time"})})}const re=({data:e,togglePopup:t,voiceSettingSave:i})=>{const{voice:s,error:n,volume:a,rate:o,pitch:g}=e,[c,u]=f.useState({voice:s,volume:a,rate:o,pitch:g}),m=p=>{if(!(p.target instanceof HTMLLinkElement))return;const{name:v,value:b}=p.target;u(D=>({...D,[v]:b}))},r=p=>{if(!(!s&&!c.voice))return i(c),p.preventDefault(),!1},h=p=>{i({...c,voice:""},!0),t(p,!1)};return l.jsx("div",{children:l.jsx("div",{className:"modal-window",children:l.jsxs("div",{children:[l.jsx("a",{href:"",title:"Close",className:"modal-close",onClick:p=>t(p,!1),children:"Close"}),l.jsx("h4",{children:"Web Speech Synthesis Demo"}),l.jsx("div",{children:l.jsxs("form",{onSubmit:()=>!1,id:"settings-form","data-voice":s,children:[l.jsxs("div",{id:"page-wrapper",children:[l.jsx("p",{id:"msg"}),l.jsxs("div",{className:"option",children:[l.jsx("label",{htmlFor:"voice",children:"Voice"})," ",l.jsx("select",{required:!0,name:"voice",id:"voice",value:c.voice||"",onChange:m})]}),l.jsxs("div",{className:"option",children:[l.jsx("label",{htmlFor:"volume",children:"Volume"}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",name:"volume",id:"volume",value:c.volume,onChange:m})]}),l.jsxs("div",{className:"option",children:[l.jsx("label",{htmlFor:"rate",children:"Rate"}),l.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",name:"rate",id:"rate",value:c.rate,onChange:m})]}),l.jsxs("div",{className:"option",children:[l.jsx("label",{htmlFor:"pitch",children:"Pitch"}),l.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",name:"pitch",id:"pitch",value:c.pitch,onChange:m})]}),n?l.jsx("div",{color:"red",children:n}):null,l.jsxs("div",{className:"btn-wrap",children:[l.jsx("button",{className:"btn btn-primary",onClick:r,children:"Save"}),"  ",l.jsx("button",{className:"btn btn-danger",onClick:h,children:"Clear Settings"})]})]}),l.jsx("div",{children:l.jsx("a",{href:"",title:"Close",className:"modal-close bottom",onClick:p=>t(p,!1),children:"Close"})})]})})]})})})};var V=typeof window>"u"?f.useEffect:f.useLayoutEffect,ae=({isPlaying:e,duration:t,startAt:i=0,updateInterval:s=0,onComplete:n,onUpdate:a})=>{let[o,g]=f.useState(i),c=f.useRef(0),u=f.useRef(i),m=f.useRef(i*-1e3),r=f.useRef(null),h=f.useRef(null),p=f.useRef(null),v=w=>{let y=w/1e3;if(h.current===null){h.current=y,r.current=requestAnimationFrame(v);return}let C=y-h.current,k=c.current+C;h.current=y,c.current=k;let R=u.current+(s===0?k:(k/s|0)*s),N=u.current+k,Y=typeof t=="number"&&N>=t;g(Y?t:R),Y||(r.current=requestAnimationFrame(v))},b=()=>{r.current&&cancelAnimationFrame(r.current),p.current&&clearTimeout(p.current),h.current=null},D=f.useCallback(w=>{b(),c.current=0;let y=typeof w=="number"?w:i;u.current=y,g(y),e&&(r.current=requestAnimationFrame(v))},[e,i]);return V(()=>{if(a==null||a(o),t&&o>=t){m.current+=t*1e3;let{shouldRepeat:w=!1,delay:y=0,newStartAt:C}=(n==null?void 0:n(m.current/1e3))||{};w&&(p.current=setTimeout(()=>D(C),y*1e3))}},[o,t]),V(()=>(e&&(r.current=requestAnimationFrame(v)),b),[e,t,s]),{elapsedTime:o,reset:D}},ce=(e,t,i)=>{let s=e/2,n=t/2,a=s-n,o=2*a,g=i==="clockwise"?"1,0":"0,1",c=2*Math.PI*a;return{path:`m ${s},${n} a ${a},${a} 0 ${g} 0,${o} a ${a},${a} 0 ${g} 0,-${o}`,pathLength:c}},q=(e,t)=>e===0||e===t?0:typeof t=="number"?e-t:0,he=e=>({position:"relative",width:e,height:e}),ue={display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",left:0,top:0,width:"100%",height:"100%"},X=(e,t,i,s,n)=>{if(s===0)return t;let a=(n?s-e:e)/s;return t+i*a},W=e=>{var t,i;return(i=(t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(s,n,a,o)=>`#${n}${n}${a}${a}${o}${o}`).substring(1).match(/.{2}/g))==null?void 0:t.map(s=>parseInt(s,16)))!=null?i:[]},de=(e,t)=>{var i;let{colors:s,colorsTime:n,isSmoothColorTransition:a=!0}=e;if(typeof s=="string")return s;let o=(i=n==null?void 0:n.findIndex((h,p)=>h>=t&&t>=n[p+1]))!=null?i:-1;if(!n||o===-1)return s[0];if(!a)return s[o];let g=n[o]-t,c=n[o]-n[o+1],u=W(s[o]),m=W(s[o+1]),r=!!e.isGrowing;return`rgb(${u.map((h,p)=>X(g,h,m[p]-h,c,r)|0).join(",")})`},me=e=>{let{duration:t,initialRemainingTime:i,updateInterval:s,size:n=180,strokeWidth:a=12,trailStrokeWidth:o,isPlaying:g=!1,isGrowing:c=!1,rotation:u="clockwise",onComplete:m,onUpdate:r}=e,h=f.useRef(),p=Math.max(a,o??0),{path:v,pathLength:b}=ce(n,p,u),{elapsedTime:D}=ae({isPlaying:g,duration:t,startAt:q(t,i),updateInterval:s,onUpdate:typeof r=="function"?y=>{let C=Math.ceil(t-y);C!==h.current&&(h.current=C,r(C))}:void 0,onComplete:typeof m=="function"?y=>{var C;let{shouldRepeat:k,delay:R,newInitialRemainingTime:N}=(C=m(y))!=null?C:{};if(k)return{shouldRepeat:k,delay:R,newStartAt:q(t,N)}}:void 0}),w=t-D;return{elapsedTime:D,path:v,pathLength:b,remainingTime:Math.ceil(w),rotation:u,size:n,stroke:de(e,w),strokeDashoffset:X(D,0,b,t,c),strokeWidth:a}},A=e=>{let{children:t,strokeLinecap:i,trailColor:s,trailStrokeWidth:n}=e,{path:a,pathLength:o,stroke:g,strokeDashoffset:c,remainingTime:u,elapsedTime:m,size:r,strokeWidth:h}=me(e);return L.createElement("div",{style:he(r)},L.createElement("svg",{viewBox:`0 0 ${r} ${r}`,width:r,height:r,xmlns:"http://www.w3.org/2000/svg"},L.createElement("path",{d:a,fill:"none",stroke:s??"#d9d9d9",strokeWidth:n??h}),L.createElement("path",{d:a,fill:"none",stroke:g,strokeLinecap:i??"round",strokeWidth:h,strokeDasharray:o,strokeDashoffset:c})),typeof t=="function"&&L.createElement("div",{style:ue},t({remainingTime:u,elapsedTime:m,color:g})))};A.displayName="CountdownCircleTimer";const I=60,P=3600,T=86400,E={isPlaying:!0,size:120,strokeWidth:6},M=(e,t)=>l.jsxs("div",{className:"time-wrapper",children:[l.jsx("div",{className:"time",children:t}),l.jsx("div",{children:e})]}),pe=e=>I-e|0,ge=e=>e%P/I|0,fe=e=>e%T/P|0,F=e=>e/T|0;let x;const ve=({t:e,reset:t,isNotifyOn:i,playSound:s})=>{const n=Date.now()/1e3,a=n+e;f.useEffect(()=>(x&&(x.onclose=()=>{t(2)},x.close()),()=>{x&&(x.onclose=()=>{t(2)},x.close())}),[e]);const o=a-n,c=Math.ceil(o/T)*T;E.size=80;const u=!!F(c-o),m=e/60/60>1;return l.jsxs(l.Fragment,{children:[u&&f.createElement(A,{...E,key:`d${e}`,colors:"#7E2E84",duration:c,initialRemainingTime:o},({elapsedTime:r,color:h})=>l.jsx("span",{style:{color:h},children:M("days",F(c-r))})),m&&f.createElement(A,{...E,key:`h${e}`,colors:"#D14081",duration:T,initialRemainingTime:o%T,onComplete:r=>({shouldRepeat:o-r>P})},({elapsedTime:r,color:h})=>l.jsx("span",{style:{color:h},children:M("hours",fe(T-r))})),f.createElement(A,{...E,key:`m${e}`,colors:"#EF798A",duration:P,initialRemainingTime:o%P,onComplete:r=>({shouldRepeat:o-r>I})},({elapsedTime:r,color:h})=>l.jsx("span",{style:{color:h},children:M("minutes",ge(P-r))})),f.createElement(A,{...E,key:`s${e}`,colors:"#218380",updateInterval:2,onUpdate:r=>{let h=document.title.split("Timer ");h=e-(60-r);const p=Math.floor(+h/60);if(p>0){const v=`${p}:${+h%60}`;document.title=`(${v}) Timer ${h}`}},duration:I,initialRemainingTime:o%I,onComplete:r=>{const h=o-r>0;if(!h){if(i)try{x=new Notification("Hi there!"),x.onclose=()=>{t(1)},x.onclick=t}catch{navigator.serviceWorker.ready.then(function(v){v.showNotification("Offline timer!",{body:"TIMER EXPIRED!"})})}s()}return{shouldRepeat:h}}},({elapsedTime:r,color:h})=>l.jsx("span",{style:{color:h},children:M("seconds",pe(r))}))]})},K="app_settings",O="app_scroll",ye="POPUP_DISCUSS",U="POPUP_SETTINGS",_=()=>$.getJ(K)||{};function Ce(){return Math.random()}const Se="/assets/alarm-clock-short-Cm5_pO2Q.mp3";let Z=!1;"Notification"in window&&Notification.requestPermission().then(function(e){Z=e==="granted"});const B=new Audio(Se);function we(){B.play().then(()=>{})}function z(){B.pause(),B.currentTime=0}const ee=[],te=[],G=new Date().getHours(),xe=new Date().getMinutes();Array.from({length:59}).map((e,t)=>{let i=t+1;i<=9&&(console.log(t,typeof t),i=`0${i}`),te.push({id:`${t+1}`,value:`${i}`})});Array.from({length:23}).map((e,t)=>{let i=[...te];if(G===t+1){const s=xe;i=i.filter(({id:n})=>+n>s)}t+1>=G&&ee.push({id:`${t+1}`,value:`${t+1}`,childs:[...i]})});let J=0;const Q=location.href.split("timer=");Q[1]&&(J=+Q[1],document.title=`Timer ${J}`);const De=[...ee],be=()=>{const[e,t]=f.useState(J),[i,s]=f.useState(De),n=c=>{if(typeof c=="number"){c===1&&(t(0),z());return}t(0),z(),window.history.pushState(null,document.title,"/"),c instanceof Function&&c()},a={ensureBtnText:"start",cancelBtnText:"cancel",wheels:[{data:i}],onChange:c=>{const u=new Date;if(c!=null&&c.length){u.setHours(c[0].id),u.setMinutes(c[1].id),u.setSeconds(0);const r=(u.getTime()-new Date().getTime())/1e3;r&&n(()=>{t(r)})}}},o=c=>{if(c.stopPropagation(),c.preventDefault(),!(c.target instanceof HTMLElement))return;const u=c.target.dataset.time;return u&&n(()=>{window.history.pushState("time","","/time?timer="+u),document.title=`Timer ${u}`,t(+u+Ce())}),!1},g=c=>{n()};return l.jsxs("div",{className:"App1",children:[l.jsxs("div",{className:"grid times",children:[l.jsx("a",{className:"btn",href:"/timer?timer=3",onClick:o,"data-time":"3",children:"3 sec"}),l.jsx("a",{className:"btn",href:"/timer?timer=600",onClick:o,"data-time":"600",children:"10 min"}),l.jsx("a",{className:"btn",href:"/timer?timer=1200",onClick:o,"data-time":"1200",children:"20 min"}),l.jsx("a",{className:"btn",href:"/timer?timer=1800",onClick:o,"data-time":"1800",children:"30 min"}),l.jsx("a",{className:"btn",href:"/timer?timer=3600",onClick:o,"data-time":"3600",children:"1 hour"}),l.jsx("a",{className:"btn",href:"/timer?timer=4800",onClick:o,"data-time":"4800",children:"1 hour 20 min"})]}),l.jsx("br",{}),l.jsx(le,{config:a}),!!e&&l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsx("div",{className:"App",children:l.jsx(ve,{t:e,reset:n,isNotifyOn:Z,playSound:we})}),l.jsx("br",{}),l.jsx("button",{className:"stop-timer btn",onClick:g,children:"Stop timer!"})]})]})};class je extends f.Component{constructor(i){super(i);j(this,"handleScroll",()=>{$.set(O,window.scrollY)});j(this,"togglePopup",(i,s=!0)=>{i.preventDefault(),this.setState({showPopupFiles:s,modal:""})});j(this,"closeModal",()=>{this.setState({modal:""})});j(this,"voiceSetting",i=>{i&&i.preventDefault(),this.setState({modal:U})});j(this,"voiceSettingSave",(i,s=!1)=>{const{voice:n,rate:a,pitch:o,volume:g}=i;if(!s){if(this.state.voice===n||!n&&this.state.voice)return this.closeModal()}const c=_();$.setJ(K,{...c,voice:n,rate:a,pitch:o,volume:g}),this.setState({modal:"",voice:n,rate:a,pitch:o,volume:g})});const{voice:s,rate:n=1,volume:a=1,pitch:o=1}=_();this.state={showStr:"",ind:0,isShown:-1,error:"",showPopupFiles:!1,modal:"",voice:s,rate:n,volume:a,pitch:o}}componentDidMount(){const i=$.get(O,"0");i&&window.scrollTo(0,+i),window.addEventListener("scroll",this.handleScroll)}componentWillUnmount(){window.removeEventListener("scroll",this.handleScroll)}render(){const{modal:i}=this.state;return l.jsxs("div",{children:[i===ye?l.jsx("div",{className:"modal-window",children:l.jsxs("div",{children:[l.jsx("a",{href:"",title:"Close",className:"modal-close",onClick:s=>this.togglePopup(s,!1),children:"Close"}),l.jsx("div",{children:l.jsx("a",{href:"",title:"Close",className:"modal-close bottom",onClick:s=>this.togglePopup(s,!1),children:"Close"})})]})}):null,l.jsx("div",{children:l.jsx("div",{className:"buttons",children:l.jsx("button",{className:"icon speech-voice-setting",onClick:this.voiceSetting})})}),i===U?l.jsx(re,{data:this.state,togglePopup:this.togglePopup,voiceSettingSave:this.voiceSettingSave}):null,l.jsx(be,{})]})}}export{je as default};
